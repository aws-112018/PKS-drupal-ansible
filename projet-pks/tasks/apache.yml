---
- name: "Installation apache"
  apt:
    name:
        - apache2
    state: present      
- debug:
    msg: "insatallation r√©ussie"i
- name: "Disable the firewall (since this is for local dev only)."
    service:
    name: ufw
    state: stopped
- name: "Start Apache, MySQL, and PHP."
  service:
    name: "{{ apache2 }}"
    state: started
    enabled: yes
- name: "Enable Apache rewrite module (required for Drupal)."
  apache2_module:
     name: rewrite
     state: present
  notify: "restart apache"
- name: "Symlink Drupal virtualhost to sites-enabled."
  file:
     src: "/etc/apache2/sites-available/{{ domain }}.test.conf"
     dest: "/etc/apache2/sites-enabled/{{ domain }}.test.conf"
     state: link
  notify: "restart apache"
- name: "Remove default virtualhost file."
  file:
     path: "/etc/apache2/sites-enabled/000-default.conf"
     state: absent
  notify: "restart apache"
- name: "Adjust OpCache memory setting."
  lineinfile:
     dest: "/etc/php/7.1/apache2/conf.d/10-opcache.ini"
     regexp: "^opcache.memory_consumption"
     line: "opcache.memory_consumption = 96"
     state: present
  notify: "restart apache"

